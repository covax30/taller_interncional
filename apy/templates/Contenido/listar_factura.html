
{% extends "generic_listar.html" %}
{% load humanize %}
{% load static %}

{% block titulo %}
        <h1 class="text-center">Lista de Facturas</h1>
{% endblock titulo %}

{% block agregar %}
<a href="{{crear_url}}" class=" btn btn-primary btn btn-xs"><i class="fas fa-plus"></i>
          Agregar
</a>
{% endblock %}

{% block columnas %}

        <th>Id de la Factura</th>
        <th>Tipo Pago</th>
        <th>Id Cliente</th>
        <th>Id Vehiculo</th>
        <th>Id Tipo Mantenimiento</th>
        <th>Servicio Prestado</th>
        <th>Nombre Empresa</th>
        <th>Direccion Empresa</th>
        <th>Id Empleado</th>
        <th>Monto</th>
        <th>Acciones</th>

{% endblock %}

{% block iterar %}

      {% for f in object_list %}
      <tr>
        <td>{{ f.id }}</td>
        <td>{{ f.tipo_pago }}</td>
        <td>{{ f.id_cliente}}</td>
        <td>{{ f.id_vehiculo}}</td>
        <td>{{ f.id_tipo_mantenimiento}}</td>
        <td>{{ f.servicio_prestado}}</td>
        <td>{{ f.nombre_empresa}}</td>
        <td>{{ f.direccion_empresa}}</td>
        <td>{{ f.id_empleado}}</td>
        <td>{{ f.monto|intcomma }}</td>
        <form method="post">

          <td>
            <a href="{% url 'apy:factura_editar' f.id %}" class="btn btn-info btn-xs"><i class="fas fa-edit"></i></a>
            <a href="{% url 'apy:factura_eliminar' f.id %}" class="btn btn-danger btn-xs"><i
                class="fas fa-trash-alt"></i></a>
            <button type="button" class="btn btn-secondary btn-xs" onclick='generarPDFFacturaDesdeDjango({
    id: "{{ f.id }}",
    tipo_pago: "{{ f.tipo_pago }}",
    id_cliente: "{{ f.id_cliente }}",
    id_vehiculo: "{{ f.id_vehiculo }}",
    id_tipo_mantenimiento: "{{ f.id_tipo_mantenimiento }}",
    servicio_prestado: `{{ f.servicio_prestado }}`,
    nombre_empresa: `{{ f.nombre_empresa }}`,
    direccion_empresa: `{{ f.direccion_empresa }}`,
    id_empleado: "{{ f.id_empleado }}",
    monto: "{{ f.monto }}"
})'>
  <i class="fas fa-print"></i>
</button>

          </td>
      </tr>
      {% endfor %}

<!-- Mensajes con SweetAlert -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  {% if messages %}
    {% for message in messages %}
      Swal.fire({
        icon: '{% if "success" in message.tags %}success{% elif "error" in message.tags %}error{% else %}info{% endif %}',
        title: '{{ message|escapejs }}',
        timer: 2500,
        showConfirmButton: false
      });
    {% endfor %}
  {% endif %}
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="{% static 'js/imprimir_factura.js' %}"></script>

{% endblock %}